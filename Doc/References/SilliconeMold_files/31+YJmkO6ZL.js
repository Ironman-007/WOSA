(function(k){var e=window.AmazonUIPageJS||window.P,u=e._namespace||e.attributeErrors,d=u?u("PageRefreshAsset",""):e;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,e,u){k.when("A","page-refresh-state","web-ajax-utility","alt-page-refresh-measurement","state-aware-feature-consolidator","page-refresh-utils").register("page-refresh-handler",function(d,f,n,b,c,g){var a={},h=d.$,l={},r="",t,m=function(a,f,e,m,k){var p=this;p.clientId=a;p.clientName=f.toLowerCase();
p.doPageRefresh=function(b,g,f){var m,q;q="";m=b["Non-Persistent"];m.hasOwnProperty("triggerEvent")&&(q=m.triggerEvent);if(void 0!==q&&""!==q&&" "!==q){m=c.getStateAwareParameters();l=h.extend(!0,l,b.Persistent);u();q=d.copy(r);h.extend(!0,q,l,b["Non-Persistent"],m);b=e;m=d.contains(b,"?");b+=m?"\x26":"?";q=w(q);for(var t in q)if(null!=q[t]){m=q[t];var p=b.slice(-1);b+="?"===p||"\x26"===p?"":"\x26";b+=t+"\x3d"+m}n.getInstance(a,b,g,f,k).getContent()}else throw"triggerEvent parameter missing or invalid";
};p.addParams=function(a){l=h.extend(!0,l,a);return!0};p.removeParams=function(a){d.each(a,function(a,b){delete l[a];delete r[a]});return!0};p.createCustomParamsMap=function(a,b){var c={Persistent:{},"Non-Persistent":{}};h.each(a,function(a,b){c.Persistent[a]=b});h.each(b,function(a,b){c["Non-Persistent"][a]=b});return c};p.startMeasurement=function(a,b,c,h,l,g){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.start(a,b,c,h,l,g)};p.stampImageLoad=function(a){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampImageLoad(a)};
p.stampFeature=function(a,b){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampFeature(a,b)};p.fadeInFeatures=function(a){"undefined"!==typeof a&&a.length||(a=t[p.clientName]);g.fadeInFeatures(a)};var u=function(){h.each(r,function(a,b){l.hasOwnProperty(a)&&(r[a]=l[a])})},w=function(a){var b={},c=Object.keys(a);c.sort();h.each(c,function(c,h){b[h]=a[h]});return b};(function(){if(m){var a=m.config;p.pageRefreshMeasurement=new b(h,a.atf.marker,a.cf.marker);p.pageRefreshMeasurement.init(m.storeID,
m.productGroupID,m.triggerEvent)}})()};(function(){var a=f.fetchPageRefreshData();r=a.pageRefreshUrlParams;t=a.divToUpdateData})();return{getHandlerInstance:function(b,c,h,l){(null==b||""===b)&&e.ueLogError&&e.ueLogError({message:"Invalid ClientId"},{logLevel:"FATAL",attribution:"PageRefreshAPI",message:"Invalid ClientId passed to getHandlerInstance of dpRefreshHandler"});a[b]||(a[b]=new m(b,c,h,l));return a[b]},getPersistentParams:function(){return l}}});"use strict";k.when("A","page-refresh-handler").register("dp-refresh-handler",
function(d,f){function n(b,c,g,a){this.featureTriggeringRefresh=b.featureName;this.deviceTypeStateData=d.state("detail-page-device-type");"undefined"===typeof this.deviceTypeStateData&&(this.deviceTypeStateData=d.state("page-refresh-device-type"));this.deviceType=this.deviceTypeStateData&&this.deviceTypeStateData.deviceType?this.deviceTypeStateData.deviceType:"web";this.pageRefreshUrl=g&&g.pageRefreshUrl?g.pageRefreshUrl:"/gp/page/refresh";this.clientId="PageRefresh_"+this.deviceType+"_"+this.featureTriggeringRefresh+
"_Client";this.DPRefreshHandler=f.getHandlerInstance(this.clientId,this.featureTriggeringRefresh,this.pageRefreshUrl,c,a)}n.prototype={doPageRefresh:function(b,c,g){try{this.DPRefreshHandler.doPageRefresh(b,c,g)}catch(a){e.ueLogError&&e.ueLogError(a,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the doPageRefresh method triggered by - "+this.featureTriggeringRefresh+": "+a})}},createCustomParamsMap:function(b,c){var g={};try{g=this.DPRefreshHandler.createCustomParamsMap(b,
c)}catch(a){e.ueLogError&&e.ueLogError(a,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the createCustomParamsMap method triggered by - "+this.featureTriggeringRefresh+": "+a})}return g},addParams:function(b){return b&&"object"==typeof b?this.DPRefreshHandler.addParams(b):!1},removeParams:function(b){return b&&"object"==typeof b?this.DPRefreshHandler.removeParams(b):!1},startMeasurement:function(b,c,g,a,h,l){try{this.DPRefreshHandler.startMeasurement(b,
c,g,a,h,l)}catch(d){e.ueLogError&&e.ueLogError(d,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+d})}},stampImageLoad:function(b){try{this.DPRefreshHandler.stampImageLoad(b)}catch(c){e.ueLogError&&e.ueLogError(c,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+
": "+c})}},stampFeature:function(b,c){try{this.DPRefreshHandler.stampFeature(b,c)}catch(g){e.ueLogError&&e.ueLogError(g,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+g})}},fadeInFeatures:function(b){try{this.DPRefreshHandler.fadeInFeatures(b)}catch(c){e.ueLogError&&e.ueLogError(c,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the fadeInFeatures method triggered by - "+
this.featureTriggeringRefresh+": "+c})}}};return n});k.when("A","jQuery").register("alt-page-refresh-ajax-scope",function(d,f){return function(f,b,c,g,a){this.scopeName=b;this.url=c;this.customPageTypeId=g;this.customTags=a;ues("t0",b,e.newTwisterInteractionStartTime);ues("ctb",b,"1");this.signalMarker=function(a){!this.markers[a]||0>=this.markers[a].conditions||0===--this.markers[a].conditions&&"function"==typeof this.markers[a].handler&&this.markers[a].handler()};this.addlongPoleTag=function(a,
b){a=a.toLowerCase();this.markers[a]&&0==this.markers[a].conditions&&0==this.markers[a].conditions&&e.ue&&"function"===typeof ue.tag&&ue.tag(b)};this.postData=function(){var a=this.scopeName,b=this.customPageTypeId,c=this.customTags;f.ajax({url:this.url,dataType:"text",timeout:4E4,error:function(){},success:function(h,g,d){h=h.trim();ues("id",a,h);var f;void 0!==b&&(f=e.ue_pti,e.ue_pti=b);if(void 0!==c)for(h=0;h<c.length;h++)ue.tag(c[h]);uex("ld",a);void 0!==b&&(e.ue_pti=f)}})};var h=this;this.markers=
{image:{conditions:1,handler:function(){uet("ne",b);h.signalMarker("af")}},af:{conditions:Twister.atfMarkerCount?Twister.atfMarkerCount:2,handler:function(){d.trigger("PageRefresh:ATF");uet("af",b);uet("cf",b);h.signalMarker("cf")}},cf:{conditions:Twister.cfMarkerCount?Twister.cfMarkerCount:2,handler:function(){d.trigger("PageRefresh:CF");uet("cf",b);h.postData()}}}}});k.when("A","jQuery","alt-page-refresh-ajax-scope").register("alt-page-refresh-measurement",function(d,f,n){return function(b,c,g){this.atfMarker=
c;this.cfMarker=g;this.scopeCount={};this.ajaxScopes={};this.url="";this.init=function(a,b,c){this.url="/gp/twister/dynamic-update/ajax-measurement.html/?s\x3d"+a+"\x26pgid\x3d"+b+"\x26deviceType\x3d"+Twister.deviceType+"\x26triggerEvent\x3d"+c;Twister.isInstaTwisterEnabled&&(this.url+="\x26ptd\x3d"+Twister.productTypeName)};this.start=function(a,c,g,d,f,m){if(e.ue){this.scopeCount[a]||(this.scopeCount[a]=0);var k=a+(this.scopeCount[a]+1);this.scopeCount[a]++;var v=this.url;c&&(v+="\x26dimensionType\x3d"+
c);"undefined"!==typeof g&&(v+="\x26dimensionCount\x3d"+g);"undefined"!==typeof d&&(v+="\x26dimensionsDisplayType\x3d"+d);this.ajaxScopes[a]=new n(b,k,v,f,m)}};this.stampImageLoad=function(a){this.ajaxScopes[a]&&(this.ajaxScopes[a].signalMarker("image"),Twister.cfImageLongPollTag&&this.ajaxScopes[a].addlongPoleTag("cf",Twister.cfImageLongPollTag))};this.stampFeature=function(a,b){this.ajaxScopes[b]&&(a===this.atfMarker&&this.ajaxScopes[b].signalMarker("af"),a===this.cfMarker&&(this.ajaxScopes[b].signalMarker("cf"),
Twister.cfHtmlLongPollTag&&this.ajaxScopes[b].addlongPoleTag("cf",Twister.cfHtmlLongPollTag)))};this.stampCustomMetrics=function(a,b){this.ajaxScopes[b]&&uet(a,this.ajaxScopes[b].scopeName)}}});k.when("A","ready","page-refresh-js-init-dpx-data","page-refresh-js-init-mason-data").register("page-refresh-state",function(d,f,e,b){function c(){var a=g.extend(!0,{},e.divToUpdateData,b.divToUpdateData),c={};d.each(a,function(a,b){c[b]=[];d.each(a,function(a){(a=a.divToUpdate)&&c[b].push(a)})});return c}
var g=d.$,a=d.state("page-refresh-data-mason"),h=d.state("page-refresh-data-dpx"),l=d.state("detail-page-device-type"),r={};"undefined"===typeof l&&(l=d.state("page-refresh-device-type"));return{fetchPageRefreshData:function(){var b=a&&a.pageRefreshUrlParams?a.pageRefreshUrlParams:{},d=h&&h.pageRefreshUrlParams?h.pageRefreshUrlParams:{};r.pageRefreshUrlParams={};g.extend(!0,r.pageRefreshUrlParams,b,d);"undefined"!==typeof l&&(r.deviceType=l.deviceType);r.divToUpdateData=c();return r}}});k.when("A",
"jQuery","page-refresh-utils","cache").register("web-ajax-utility",function(d,f,n,b){function c(a,b,c,g,d){this.scope=a;this.url=b;this.options=c;this.useCustomRefreshBehavior=d;this.status=0;this.selected=!1;this.error=this.successData=this.xhr=this._status=void 0;this.chunks=[];this.doNotAbort=g||!1}var g=new b;c._objects={};c.prototype._initializeChunks=function(){var a=!1;g.exists(this.url)&&(a=!0,this.chunks=g.get(this.url));return a};c.prototype._callback=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,
1);"function"===typeof a&&a.apply(self,b)};c.prototype._canAbort=function(){return!this.doNotAbort&&1===this.status};c.prototype._isAborted=function(){return 3===this.status};c.prototype._getUrl=function(){return this.url};c.prototype._abort=function(){if(1===this.status)try{this.ajaxRequestRefence.abort(),this.status=3}catch(b){var a={message:"Could not abort ajax request. "};"string"===typeof b&&(a.message+=b,b=void 0);a.logLevel="FATAL";e.ueLogError&&e.ueLogError(b,a)}};c.prototype._flushChunkData=
function(){var a=this;a.chunks.length&&f.map(a.chunks,function(b){a.useCustomRefreshBehavior||n.refreshFeature(b);a._callback(a.options.chunk,b)})};c.prototype._request=function(){var a=this;a.ajaxRequestRefence=d.get(a.url,{params:a.options.params,success:function(b,c,f){a.status=4;a.successData=b;a._status=c;a.xhr=f;g.put(a.url,a.chunks);a.chunks=[];a.selected&&(a.useCustomRefreshBehavior||n.removeOverlayForAllFeatures(),a._callback(a.options.success,b,c,f));d.trigger("PageRefresh:Success")},error:function(b,
c,g){a.status=2;a.xhr=b;a._status=c;a.error=g;a.selected&&(a.useCustomRefreshBehavior||n.removeOverlayForAllFeatures(),a._callback(a.options.error,b,c,g))},abort:function(b){a.status=3;a.xhr=b;a.selected&&a._callback(a.options.abort,b)},chunk:function(b){b&&(a.chunks.push(b),a.selected&&(a.useCustomRefreshBehavior||n.refreshFeature(b),a._callback(a.options.chunk,b)))},timeout:a.options.timeout||4E4})};c.prototype.getContent=function(){c._abortRequestsExcept(this);this.selected=!0;var a=this._initializeChunks();
a&&(this.status=4);0===this.status?(this.status=1,this._request()):1===this.status?this._flushChunkData():4===this.status&&(a?(this._flushChunkData(),this.useCustomRefreshBehavior||n.removeOverlayForAllFeatures(),this._callback(this.options.success,this.successData,this._status,this.xhr),d.trigger("a:pageUpdate"),d.trigger("PageRefresh:Success")):(this.status=1,this._request()))};c._abortRequestsExcept=function(a){f.each(c._objects[a.scope],function(b,c){c._canAbort()&&b!==a._getUrl()&&c._abort()})};
c.getInstance=function(a,b,g,d,f){if(!a||!b||"object"!==typeof g)throw"Incorrect parameter passed.";f=f||!1;c._objects[a]=c._objects[a]||{};var e=c._objects[a][b];e&&e._isAborted()&&(delete c._objects[a][b],e=void 0);e||(c._objects[a][b]=new c(a,b,g,d,f,this));return c._objects[a][b]};return c});k.when("A").register("state-aware-critical-features",function(d){return function(){var d=[];this.add=function(e,b){for(var c=e.featureName,g=!1,a=0;a<d.length;a++)if(d[a].featureName===c){g=!0;break}if(g)throw"Critical Feature "+
e.featureName+" already registered for State Aware Messaging!";e={};e.featureName=c;e.callback=b;d.push(e)};this.getAllCriticalFeatures=function(){return d}}});k.when("A","state-aware-parameter-handler").register("state-aware-feature-consolidator",function(d,f){return{getStateAwareParameters:function(){return f.getStateAwareParameters()}}});k.when("A","state-aware-critical-features","state-aware-parameters").register("state-aware-parameter-handler",function(d,f,n){return new function(){var b=new f,
c=new n;this.registerCriticalFeature=function(c,a){try{if("function"===typeof a)b.add(c,a);else throw"callback needs to be a function!";}catch(d){e.ueLogError&&e.ueLogError(d,{logLevel:"ERROR",attribution:c.featureName,message:"StateAwareExceptionMessaging:- This error is caused by the feature "+c.featureName+" while registering itself as a critical feature for State Aware Messaging. "+d})}};this.getStateAwareParameters=function(){for(var d=b.getAllCriticalFeatures(),a=0;a<d.length;a++){var f=d[a],
n=f.featureName,f=f.callback.apply();try{c.putParameters(n,f)}catch(k){e.ueLogError&&e.ueLogError(k,{logLevel:"ERROR",attribution:n,message:"StateAwareMessaging:- This error is caused by the feature "+n+" while injecting state aware parameters. "+k})}}return c.getAllStateAwareParameters()}}});k.when("A").register("state-aware-parameters",function(){return function(){var d={};this.putParameters=function(f,e){var b=!0;for(feature in d)if(d.hasOwnProperty(feature)&&f!==feature){var c=this.getParameters(feature);
if(b){var b=e,g=!1;for(paramKey in b)if(b.hasOwnProperty(paramKey)&&c.hasOwnProperty(paramKey)){g=!0;break}b=!g}}if(b)for(paramKey in e)e.hasOwnProperty(paramKey)&&(c=e[paramKey],d[f]||(d[f]={}),d[f][paramKey]=c);else throw"Duplicate Parameters found for other Critical Feature!";};this.getParameters=function(f){return d[f]};this.getAllStateAwareParameters=function(){var f={},e;for(e in d)if(d.hasOwnProperty(e)){var b=this.getParameters(e),c;for(c in b)b.hasOwnProperty(c)&&(f[c]=b[c])}return f}}});
k.when("A").register("page-refresh-utils",function(d){var f=d.$,k={intermediateEOS:1,EOS:1};return{fadeInFeatures:function(b){f.each(b,function(c,a){"#"!==a[0]&&(b[c]="#"+a)});var c=b.join(",");f(c).addClass("js-feature-refresh-overlay");f(c).css("opacity",.5)},refreshFeature:function(b){var c=b.Value;b=b.FeatureName;if(!k[b]){var d,a;try{b&&c&&c.content&&(a=c.content[b],"undefined"!==typeof a&&(d=f("#"+b),d.html(a),d.removeClass("js-feature-refresh-overlay"),d.css("opacity","")))}catch(h){c={message:"Error in feature"+
(b||"NoFeatureName"),logLevel:"FATAL"},e.ueLogError&&e.ueLogError(h,c)}}},removeOverlayForAllFeatures:function(b){b=f("body").find(".js-feature-refresh-overlay");for(var c=0;c<b.length;c++){var d=b[c];f(d).removeClass("js-feature-refresh-overlay");f(d).css("opacity","")}}}})});